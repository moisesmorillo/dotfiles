#!/bin/bash
# shellcheck disable=SC1090

# This function is used to test the speed of zsh startup
zsh_time() {
	repeat 10 time zsh -i -c exit
}

# This function is used to update the OS packages, dotfiles and LazyVim core and plugins
fu() {
	OS=$(uname -s)

	echo "*** Updating OS packages***"

	if [[ "$OS" == "Darwin" ]]; then
		brew update
		brew upgrade
	fi

	if [[ "$OS" == "Linux" ]]; then
		sudo apt update -y
		sudo apt full-upgrade -y
		sudo apt autoremove -y
		sudo apt autoclean -y
	fi

	echo "*** Updating dotfiles ***"
	cd ~/projects/dotfiles/ && git pull origin main && cd - || exit

	echo "*** Updating LazyVim core and plugins ***"
	nvim --headless "+Lazy! sync" +qa
}

# This function is used to reload the zsh configuration
zsh_reload() {
	echo "*** Reloading zsh configuration ***"
	source ~/.zshrc
}

# This function is used to re-stow the dotfiles
stow_dotfiles() {
	echo "*** Restowing dotfiles ***"
	cd ~/projects/dotfiles/ && stow -R -t "$HOME" ./* && cd - || return
}

# This function is used to kill the orbstack process (docker)
kdo() {
	pgrep -fi orbstack | xargs kill
}

reinstall_lazyvim() {
	echo "*** Reinstalling LazyVim ***"
	cd ~/projects/dotfiles/ || return
	stow -D nvim -t "$HOME"
	rm -rf ~/.config/nvim/ ~/.local/share/nvim/ ~/.local/state/nvim/ ~/.cache/nvim/
	stow -R -t "$HOME" nvim
	cd - || return
	nvim --headless "+Lazy! sync" +qa
}
